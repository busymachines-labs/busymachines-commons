<html><head><title>busymachines-commmons: Publishing Artifacts</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="com.busymachines" /><meta name="description" content="Light-weight, modular eco-system of libraries needed to build HTTP web apps in Scala" /><meta name="og:image" content="/busymachines-commons/img/poster.png" /><meta name="og:title" content="busymachines-commmons: Publishing Artifacts" /><meta name="og:site_name" content="busymachines-commmons" /><meta name="og:url" content="http://busymachines.github.io/busymachines-commons/" /><meta name="og:type" content="website" /><meta name="og:description" content="Light-weight, modular eco-system of libraries needed to build HTTP web apps in Scala" /><link rel="icon" type="image/png" href="/busymachines-commons/img/favicon.png" /><meta name="twitter:title" content="busymachines-commmons: Publishing Artifacts" /><meta name="twitter:image" content="http://busymachines.github.io/busymachines-commons/img/poster.png" /><meta name="twitter:description" content="Light-weight, modular eco-system of libraries needed to build HTTP web apps in Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/busymachines-commons/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/busymachines-commons/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/busymachines-commons/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/busymachines-commons/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/busymachines-commons/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/busymachines-commons/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/busymachines-commons/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/busymachines-commons/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/busymachines-commons/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/busymachines-commons/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/busymachines-commons/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/busymachines-commons/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/busymachines-commons/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/busymachines-commons/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/busymachines-commons/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/busymachines-commons/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/busymachines-commons/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/busymachines-commons/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/busymachines-commons/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/busymachines-commons/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/busymachines-commons/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/busymachines-commons/css/style.css" /><link rel="stylesheet" href="/busymachines-commons/css/palette.css" /><link rel="stylesheet" href="/busymachines-commons/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/busymachines-commons/" class="brand"><div class="brand-wrapper"><span>busymachines-commmons</span></div></a></li> <li><a href="/busymachines-commons/docs/index.html" class="">Getting Started</a></li> <li><a href="/busymachines-commons/docs/help.html" class="">Help!</a></li> <li><a href="/busymachines-commons/docs/learning.html" class="">Learning Materials</a></li> <li><a href="/busymachines-commons/docs/developer-guide.html" class="">Developer's Guide</a></li> <li><a href="/busymachines-commons/docs/core.html" class="">core</a></li> <li><a href="/busymachines-commons/docs/duration.html" class="">duration</a></li> <li><a href="/busymachines-commons/docs/effects.html" class="">effects</a></li> <li><a href="/busymachines-commons/docs/json.html" class="">json</a></li> <li><a href="/busymachines-commons/docs/rest.html" class="">rest</a></li> <li><a href="/busymachines-commons/docs/rest-testkit.html" class="">rest-testkit</a></li> <li><a href="/busymachines-commons/docs/semver.html" class="">semver</a></li> <li><a href="/busymachines-commons/docs/semver-parsers.html" class="">semver-parsers</a></li> <li><a href="/busymachines-commons/docs/publishing-artifacts.html" class=" active ">Publishing Artifacts</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/busymachines/busymachines-commons"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/busymachines/busymachines-commons"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('busymachines-commmons Light-weight, modular eco-system of libraries needed to build HTTP web apps in Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('busymachines-commmons Light-weight, modular eco-system of libraries needed to build HTTP web apps in Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="busymachines" data-github-repo="busymachines-commons"><div class="content-wrapper"><section><h1 id="sbt-local-config-example">SBT local config example</h1>

<p>All references to a “folder” refer to the <a href="https://github.com/busymachines/busymachines-commons/tree/master/z-publishing-artifacts">z-publishing-artifacts</a> folder from the github repo.</p>

<p>This folder is useful to you <em>only</em> if you are responsible for publishing this library to the Sonatype repository, otherwise it can be completely ignored.</p>

<p>The contents of this folder ought to be copied to your <code class="highlighter-rouge">~/.sbt/1.0</code> folder. And the appropriate values assigned to each sbt key, as described below.</p>

<p>Each of the following sections describes the purpose of the files in the <code class="highlighter-rouge">z-publishing-artifacts</code> folder <em>once copied to <code class="highlighter-rouge">~/.sbt/1.0</code></em>.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree
.
├── README.md
├── pgp.sbt
├── plugins
│   └── plugins.sbt
└── sonatype.sbt
</code></pre></div></div>

<h2 id="pluginspluginssbt"><a href="https://github.com/busymachines/busymachines-commons/blob/master/z-publishing-artifacts/plugins/plugins.sbt">plugins/plugins.sbt</a></h2>

<p>If copied in your global <code class="highlighter-rouge">sbt</code> config this will load the <a href="https://github.com/sbt/sbt-pgp">sbt-pgp</a> as a global plugin for your machine.</p>

<p>Note that for this to work you need to have <a href="https://gpgtools.org/">PGP tools</a> installed on your machine! By default this build will look that it has a <code class="highlighter-rouge">pgp</code> command available in your <code class="highlighter-rouge">$PATH</code>.</p>

<p>Content:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">addSbtPlugin</span><span class="o">(</span><span class="s">"com.jsuereth"</span> <span class="o">%</span> <span class="s">"sbt-pgp"</span> <span class="o">%</span> <span class="s">"2.0.0-M2"</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="pgpsbt"><a href="https://github.com/busymachines/busymachines-commons/blob/master/z-publishing-artifacts/pgp.sbt">pgp.sbt</a></h2>
<p>As required by the <code class="highlighter-rouge">sbt-pgp</code> plugin required above, this file contains the paths to your PGP keys, and — optionally — the path to the <code class="highlighter-rouge">gpg</code> command on your system if it’s not available in your global <code class="highlighter-rouge">$PATH</code> variable`:</p>

<p>Content:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">com</span><span class="o">.</span><span class="n">typesafe</span><span class="o">.</span><span class="n">sbt</span><span class="o">.</span><span class="n">pgp</span><span class="o">.</span><span class="nc">PgpKeys</span><span class="o">.</span><span class="n">pgpPublicRing</span> <span class="o">:=</span> <span class="n">file</span><span class="o">(</span><span class="s">"~/.gnupg/pubring.kbx"</span><span class="o">)</span>
<span class="c1">// com.typesafe.sbt.pgp.PgpKeys.gpgCommand := "/path/to/gpg"
</span>
<span class="c1">//run to ensure you have the full key id, as required by SBT: gpg --keyid-format LONG -k
// usePgpKeyHex("FULL_HEX_KEY_ID_HERE")
</span>
<span class="c1">//for easy copy pasting just run this in your sbt scala REPL (invoked by &gt; console):
// """thepasswordofthekey""".map(c =&gt; s""" '$c' """).mkString(",")
</span><span class="n">com</span><span class="o">.</span><span class="n">typesafe</span><span class="o">.</span><span class="n">sbt</span><span class="o">.</span><span class="n">pgp</span><span class="o">.</span><span class="nc">PgpKeys</span><span class="o">.</span><span class="n">pgpPassphrase</span> <span class="o">:=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="sc">'t'</span><span class="o">,</span> <span class="sc">'h'</span><span class="o">,</span> <span class="sc">'e'</span><span class="o">,</span> <span class="sc">'p'</span><span class="o">,</span> <span class="sc">'a'</span><span class="o">,</span> <span class="sc">'s'</span><span class="o">,</span> <span class="sc">'w'</span><span class="o">,</span> <span class="sc">'o'</span><span class="o">,</span> <span class="sc">'r'</span><span class="o">,</span> <span class="sc">'d'</span><span class="o">,</span> <span class="sc">'o'</span><span class="o">,</span> <span class="sc">'f'</span><span class="o">,</span> <span class="sc">'t'</span><span class="o">,</span> <span class="sc">'h'</span><span class="o">,</span> <span class="sc">'e'</span><span class="o">,</span> <span class="sc">'k'</span><span class="o">,</span> <span class="sc">'e'</span><span class="o">,</span> <span class="sc">'y'</span><span class="o">))</span>
</code></pre></div></div>

<h2 id="sonatypesbt"><a href="https://github.com/busymachines/busymachines-commons/blob/master/z-publishing-artifacts/sonatype.sbt">sonatype.sbt</a></h2>

<p>This file contains the username and passwords for the Sonatype repository:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">credentials</span> <span class="o">+=</span> <span class="nc">Credentials</span><span class="o">(</span>
  <span class="s">"Sonatype Nexus Repository Manager"</span><span class="o">,</span>
  <span class="s">"oss.sonatype.org"</span><span class="o">,</span>
  <span class="s">"$USERNAME_ON_SONATYPE_JIRA"</span><span class="o">,</span>
  <span class="s">"$PASSWORD_ON_SONATYPE_JIRA"</span>
<span class="o">)</span>
</code></pre></div></div>

<p>Currently we have only one sonatype user who uses this account, as can be seen in this issue on their JIRA:
<a href="https://issues.sonatype.org/browse/OSSRH-33718">https://issues.sonatype.org/browse/OSSRH-33718</a>.</p>

<p>More users can be given access by commenting on the above JIRA issue.</p>

<h2 id="after-everything-is-setup">After everything is setup</h2>

<p>You ought to follow the instructions here to create your PGP file:
<a href="http://www.scala-sbt.org/release/docs/Using-Sonatype.html#PGP+Tips%E2%80%99n%E2%80%99tricks">http://www.scala-sbt.org/release/docs/Using-Sonatype.html#PGP+Tips%E2%80%99n%E2%80%99tricks</a></p>

<h2 id="publishing--the-easy-way">Publishing — the easy way</h2>

<p>simply run the sbt command:</p>
<ol>
  <li><code class="highlighter-rouge">doRelease</code></li>
</ol>

<p>It’s an alias for the hard way described bellow if you wish to learn the details.</p>

<h2 id="publishing--the-hard-way">Publishing — the hard way</h2>

<p>The verbose way of publishing your artifact to the Central Repository is as follows:</p>
<ol>
  <li><code class="highlighter-rouge">publishSigned</code></li>
  <li><code class="highlighter-rouge">sonatypeRelease</code>
If this doesn’t work for some reason, then read further to understand the entire process.</li>
</ol>

<h3 id="full-workflow">Full-workflow</h3>

<p>Full workflow to <a href="http://www.scala-sbt.org/release/docs/Using-Sonatype.html#Using+Sonatype">publish to sonatype</a> can be found on the sbt website, and you really need to read it all. <em>DO NOT FORGET</em> to distribute your PGP keys to the keyserver pool by running the sbt task from <a href="https://www.scala-sbt.org/release/docs/Using-Sonatype.html#PGP+Tips%E2%80%99n%E2%80%99tricks">PGP Tips’n’tricks</a> section from the aforementione guide.</p>

<h3 id="open-staging-profile">Open staging profile</h3>

<p>Outlined here on the <a href="https://github.com/xerial/sbt-sonatype/blob/master/workflow.md">sbt-sonatype</a> plugin page.</p>

<h3 id="then-run-the-commands-outlined-on-the-sbt-sonatype-page-copy-pasted-from-there-for-our-convenience">Then Run the commands outlined on the <a href="https://github.com/xerial/sbt-sonatype#publishing-your-artifact">sbt-sonatype</a> page. Copy pasted from there for our convenience:</h3>

<h4 id="publishsigned"><code class="highlighter-rouge">publishSigned</code></h4>

<p>To deploy your artifact to staging repository at Sonatype. Implicitely creates a staging repository which you can view online at <a href="https://oss.sonatype.org/#stagingRepositories">https://oss.sonatype.org/#stagingRepositories</a>. You can login using the sonatype jira credentials you had to gain in previous steps.</p>

<h4 id="sonatyperelease"><code class="highlighter-rouge">sonatypeRelease</code></h4>

<p>To do <code class="highlighter-rouge">sonatypeClose</code> and <code class="highlighter-rouge">sonatypePromote</code> in one step:</p>
<ul>
  <li><code class="highlighter-rouge">sonatypeClose</code> closes your staging repository at Sonatype. This step verifies Maven central sync requirement, GPG-signature, javadoc
   and source code presence, pom.xml settings, etc.</li>
  <li><code class="highlighter-rouge">sonatypePromote</code> command verifies the closed repository so that it can be synchronized with Maven central.</li>
</ul>

<h4 id="other-commands"><a href="https://github.com/xerial/sbt-sonatype#available-commands">other commands</a></h4>

<p>Note: If your project version has “SNAPSHOT” suffix, your project will be published to the <a href="http://oss.sonatype.org/content/repositories/snapshots">snapshot repository</a> of Sonatype, and you cannot use <code class="highlighter-rouge">sonatypeRelease</code> command.</p>

<h4 id="command-line-usage">Command Line Usage</h4>

<p>Publish a GPG-signed artifact to Sonatype:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sbt publishSigned
</code></pre></div></div>

<p>Do close and promote at once:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sbt sonatypeRelease
</code></pre></div></div>
<p>This command accesses <a href="https://oss.sonatype.org/nexus-staging-plugin/default/docs/index.html">Sonatype Nexus REST API</a>, then sends close and promote commands.</p>

<h4 id="publish-docs">Publish docs</h4>

<p>Don’t forget to run the <code class="highlighter-rouge">doSitePublish</code> task to publish your newly updated docs.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/busymachines-commons/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'busymachines/busymachines-commons'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/busymachines-commons/js/main.js"></script></body></html>